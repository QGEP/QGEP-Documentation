

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1.4. Configuration du poste de travail &mdash; Documentation QGEP 0.8</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Recherche" href="../search.html"/>
    <link rel="top" title="Documentation QGEP 0.8" href="../index.html"/>
        <link rel="up" title="1. Guide d’installation de QGEP" href="index.html"/>
        <link rel="next" title="2. Guide d’utilisateur de QGEP" href="../user-guide/index.html"/>
        <link rel="prev" title="1.3. Initialisation de la base de données" href="database-initialization.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="../index.html" class="icon icon-home"> QGEP
        

        
        </a>

        
          
          
            <div class="version">
              0.7
            </div>
          
        

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">1. Guide d’installation de QGEP</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="requirements.html">1.1. Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="server.html">1.2. Configuration du serveur de base de données</a></li>
<li class="toctree-l2"><a class="reference internal" href="database-initialization.html">1.3. Initialisation de la base de données</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">1.4. Configuration du poste de travail</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#database-configuration">1.4.1. Configuration de la base de données</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#windows-pg-service">1.4.1.1. Windows pg_service</a></li>
<li class="toctree-l4"><a class="reference internal" href="#linux-pg-service">1.4.1.2. Linux pg_service</a></li>
<li class="toctree-l4"><a class="reference internal" href="#all-systems">1.4.1.3. Tous les systèmes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#install-qgis">1.4.2. Installer QGIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#install-qgep-plugin">1.4.3. Installer le plugin QGEP</a></li>
<li class="toctree-l3"><a class="reference internal" href="#install-the-demo-data">1.4.4. Install the demo data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#install-the-demo-project">1.4.5. Installation du projet de démo</a></li>
<li class="toctree-l3"><a class="reference internal" href="#add-your-own-oid-in-the-project">1.4.6. Ajouter votre propre IDO dans le projet</a></li>
<li class="toctree-l3"><a class="reference internal" href="#working-with-more-than-one-database">1.4.7. Travailler avec plusieurs base de  données</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user-guide/index.html">2. Guide d’utilisateur de QGEP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/index.html">3. Guide d’administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vm/index.html">4. Machine virtuelle de démonstration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wincan2qgep/index.html">5. Plugin Wincan 2 QGEP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../qgep_swmm/index.html">6. QGEP SWMM plugin</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">QGEP</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html"><span class="section-number">1. </span>Guide d’installation de QGEP</a> &raquo;</li>
      
    <li><span class="section-number">1.4. </span>Configuration du poste de travail</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/installation-guide/workstation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="setup-workstation">
<h1><span class="section-number">1.4. </span>Configuration du poste de travail<a class="headerlink" href="#setup-workstation" title="Lien permanent vers ce titre">¶</a></h1>
<div class="section" id="database-configuration">
<h2><span class="section-number">1.4.1. </span>Configuration de la base de données<a class="headerlink" href="#database-configuration" title="Lien permanent vers ce titre">¶</a></h2>
<p>Pour que la station de travail sache où se trouve la base de données (sur le serveur local ou en réseau) il faut commencer par créer un fichier sur toutes les stations où QGIS/QGEP sera utilisé. Il n’est pas nécessaire de le faire sur le serveur lui-même.</p>
<p>Ces étapes dépendent de votre système d’exploitation.</p>
<div class="section" id="windows-pg-service">
<h3><span class="section-number">1.4.1.1. </span>Windows pg_service<a class="headerlink" href="#windows-pg-service" title="Lien permanent vers ce titre">¶</a></h3>
<p>Créer un nouveau dossier où vous souhaitez enregister la configuration. Par exemple <code class="docutils literal notranslate"><span class="pre">pgconfig</span></code> dans vos documents. Ce dossier sera connu sous le nom de <code class="docutils literal notranslate"><span class="pre">PGSYSCONFDIR</span></code> dans ce guide.</p>
<p>Configurer la variable d’environnement <code class="docutils literal notranslate"><span class="pre">PGSYSCONFDIR</span></code> pour pointer sur le chemin de <code class="docutils literal notranslate"><span class="pre">PGSYSCONFDIR</span></code></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Search for environment variable in your windows system settings, then click one of the following options, for either a user or a system variable:</p>
<blockquote>
<div><p>Click <code class="docutils literal notranslate"><span class="pre">New</span></code> to add a new variable name and value.
Click an existing variable, and then click <code class="docutils literal notranslate"><span class="pre">Edit</span></code> to change its name or value.
Click an existing variable, and then click <code class="docutils literal notranslate"><span class="pre">Delete</span></code> to remove it.</p>
</div></blockquote>
<div class="figure align-default">
<img alt="../_images/umgebungsvariablen_pgconfdir.jpg" src="../_images/umgebungsvariablen_pgconfdir.jpg" />
</div>
<p>You can check your environment variables also within QGIS: Menu <code class="docutils literal notranslate"><span class="pre">Settings</span></code> –&gt; <code class="docutils literal notranslate"><span class="pre">Options...</span></code> –&gt; <code class="docutils literal notranslate"><span class="pre">System</span></code> Tab  –&gt; <code class="docutils literal notranslate"><span class="pre">Environment</span></code></p>
</div>
<p>Dans ce dossier, vous trouverez deux fichiers</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pg_service.conf</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pgpass</span></code> (si vous ne souhaitez pas entrer le mot de passe à chaque connexion)</p></li>
</ul>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>On Windows, you need to save <code class="docutils literal notranslate"><span class="pre">pg_service.conf</span></code> in Unix format in order to work.
One way to do it is to open it with <a class="reference external" href="https://notepad-plus-plus.org/">Notepad++</a>
and <code class="docutils literal notranslate"><span class="pre">Edit</span></code> –&gt; <code class="docutils literal notranslate"><span class="pre">EOL</span> <span class="pre">Conversion</span></code> –&gt; <code class="docutils literal notranslate"><span class="pre">UNIX</span> <span class="pre">Format</span></code> –&gt; <code class="docutils literal notranslate"><span class="pre">File</span> <span class="pre">save</span></code> .</p>
</div>
</div>
<div class="section" id="linux-pg-service">
<span id="pg-service-linux"></span><h3><span class="section-number">1.4.1.2. </span>Linux pg_service<a class="headerlink" href="#linux-pg-service" title="Lien permanent vers ce titre">¶</a></h3>
<p>On <a href="#id1"><span class="problematic" id="id2">*</span></a>nix systems (linux/macOS etc.) you may put the files <code class="docutils literal notranslate"><span class="pre">.pg_service.conf</span></code>
and <code class="docutils literal notranslate"><span class="pre">.pgpass</span></code> into your home folder (normally <code class="docutils literal notranslate"><span class="pre">/home/[username]</span></code>).</p>
</div>
<div class="section" id="all-systems">
<h3><span class="section-number">1.4.1.3. </span>Tous les systèmes<a class="headerlink" href="#all-systems" title="Lien permanent vers ce titre">¶</a></h3>
<p>Placer les lignes suivantes dans le fichier <code class="docutils literal notranslate"><span class="pre">pg_service.conf</span></code> ou <code class="docutils literal notranslate"><span class="pre">.pg_service.conf</span></code>. Vous devrez peut-être apporter des modifications selon votre configuration.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[pg_qgep]</span>
<span class="na">host</span><span class="o">=</span><span class="s">localhost</span>
<span class="na">port</span><span class="o">=</span><span class="s">5432</span>
<span class="na">dbname</span><span class="o">=</span><span class="s">qgep</span>
<span class="na">user</span><span class="o">=</span><span class="s">qgepuser</span>
</pre></div>
</div>
<p>Pour enregistrer le mot de passe sur votre système, vous pouvez utiliser le fichier <a class="reference external" href="http://www.postgresql.org/docs/current/static/libpq-pgpass.html">pgpass</a>.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">localhost:5432:*:qgepuser:password</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Si la base de données n’est pas sur votre poste local, remplacer toutes les occurences de <code class="docutils literal notranslate"><span class="pre">localhost</span></code> par l’adresse réseau du serveur de base de données.</p>
</div>
</div>
</div>
<div class="section" id="install-qgis">
<h2><span class="section-number">1.4.2. </span>Installer QGIS<a class="headerlink" href="#install-qgis" title="Lien permanent vers ce titre">¶</a></h2>
<ul class="simple">
<li><p>Configuration minimale 3.4</p></li>
<li><p>Nous vous recommandons l’utilisation des versions de développements de QGIS (appelées qgis-dev sous Windows). Elles offriront une meilleure expérience utilisateur avec QGEP. Pour une installation sur Windows, télécharger l’installeur <a class="reference external" href="http://download.osgeo.org/osgeo4w/osgeo4w-setup-x86_64.exe">OSGeo4W Installer</a>  , choisir <em>installation avancée</em> et installer qgis-dev.</p></li>
</ul>
</div>
<div class="section" id="install-qgep-plugin">
<h2><span class="section-number">1.4.3. </span>Installer le plugin QGEP<a class="headerlink" href="#install-qgep-plugin" title="Lien permanent vers ce titre">¶</a></h2>
<p>Exigences du plugin;</p>
<ul class="simple">
<li><p>networkx &gt;= 2.1</p></li>
</ul>
<p>Vous pouvez les installer sur un système Debian avec:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">networkx</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">libqt4</span><span class="o">-</span><span class="n">sql</span><span class="o">-</span><span class="n">psql</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Ouvrir QGIS</p></li>
<li><p>Go to <code class="docutils literal notranslate"><span class="pre">Plugins</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Manage</span> <span class="pre">and</span> <span class="pre">Install</span> <span class="pre">Plugins</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Settings</span></code></p>
<ul>
<li><p>Enable <code class="docutils literal notranslate"><span class="pre">Show</span> <span class="pre">also</span> <span class="pre">experimental</span> <span class="pre">plugins</span></code></p></li>
</ul>
</li>
<li><p>Activer le plugin (voir l’image ci-dessous):</p></li>
<li><p>Tous</p>
<ul>
<li><p>Chercher <cite>QGEP</cite></p></li>
<li><p>Cocher la case à côté</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="figure align-default" id="id3">
<img alt="../_images/001_searchplugin.jpeg" src="../_images/001_searchplugin.jpeg" />
<p class="caption"><span class="caption-text"><strong>Ajouter le plugin QGEP</strong></span><a class="headerlink" href="#id3" title="Lien permanent vers cette image">¶</a></p>
</div>
<p>QGEP uses a data historization process. The <code class="docutils literal notranslate"><span class="pre">pg</span> <span class="pre">history</span> <span class="pre">viewer</span></code> <a class="reference external" href="http://plugins.qgis.org/plugins/pg_history_viewer/">plugin</a> allows you to view the changes made and replay some of them.</p>
</div>
<div class="section" id="install-the-demo-data">
<h2><span class="section-number">1.4.4. </span>Install the demo data<a class="headerlink" href="#install-the-demo-data" title="Lien permanent vers ce titre">¶</a></h2>
<ul class="simple">
<li><p>Download from <a class="reference external" href="https://github.com/QGEP/datamodel/releases/latest">https://github.com/QGEP/datamodel/releases/latest</a>
New Restore file: qgep_vx.x.x_structure_and_demo_data.backup (with data), other versions with schema only available</p></li>
<li><p>Extraire le ficher</p></li>
<li><p>Restore the file <cite>qgep_vx.x.x_structure_and_demo_data.backup</cite> with pgAdmin</p></li>
</ul>
</div>
<div class="section" id="install-the-demo-project">
<h2><span class="section-number">1.4.5. </span>Installation du projet de démo<a class="headerlink" href="#install-the-demo-project" title="Lien permanent vers ce titre">¶</a></h2>
<ul class="simple">
<li><p>Download from <a class="reference external" href="https://github.com/QGEP/qgep/releases/latest">https://github.com/QGEP/qgep/releases/latest</a> the qgep.zip</p></li>
<li><p>Extraire le ficher</p></li>
<li><p>If you leave the qgep_[language].qm - file in the same directory as the qgep.qgs - file and start QGIS with language, your qgep-project will be translated if you start the project.</p></li>
<li><p>Open <cite>project/qgep.qgs</cite> with QGIS</p></li>
</ul>
</div>
<div class="section" id="add-your-own-oid-in-the-project">
<h2><span class="section-number">1.4.6. </span>Ajouter votre propre IDO dans le projet<a class="headerlink" href="#add-your-own-oid-in-the-project" title="Lien permanent vers ce titre">¶</a></h2>
<ul class="simple">
<li><p>You have to add your OID data in the table qgep_sys.oid_prefixes:</p></li>
</ul>
<div class="figure align-default">
<img alt="../_images/oid_prefix.jpg" src="../_images/oid_prefix.jpg" />
</div>
<ul class="simple">
<li><p>Edit <code class="docutils literal notranslate"><span class="pre">02_oid_generation.sql</span></code> with your OID if you want it permanently in the QGEP project and hand in a pull request</p></li>
</ul>
<p><a class="reference external" href="https://github.com/QGEP/datamodel/blob/master/02_oid_generation.sql">https://github.com/QGEP/datamodel/blob/master/02_oid_generation.sql</a></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- sample entry for the City of Uster - you need to add an entry for your own organization</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">qgep_sys</span><span class="p">.</span><span class="n">oid_prefixes</span> <span class="p">(</span><span class="k">prefix</span><span class="p">,</span><span class="n">organization</span><span class="p">,</span><span class="n">active</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">&#39;ch11h8mw&#39;</span><span class="p">,</span><span class="s1">&#39;Stadt Uster&#39;</span><span class="p">,</span><span class="k">TRUE</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">qgep_sys</span><span class="p">.</span><span class="n">oid_prefixes</span> <span class="p">(</span><span class="k">prefix</span><span class="p">,</span><span class="n">organization</span><span class="p">,</span><span class="n">active</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">&#39;ch15z36d&#39;</span><span class="p">,</span><span class="s1">&#39;SIGE&#39;</span><span class="p">,</span><span class="k">FALSE</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">qgep_sys</span><span class="p">.</span><span class="n">oid_prefixes</span> <span class="p">(</span><span class="k">prefix</span><span class="p">,</span><span class="n">organization</span><span class="p">,</span><span class="n">active</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">&#39;ch13p7mz&#39;</span><span class="p">,</span><span class="s1">&#39;Arbon&#39;</span><span class="p">,</span><span class="k">FALSE</span><span class="p">);</span>
</pre></div>
</div>
<p>et définir la valeur de l’IDO que vous voulez utiliser dans votre projet à VRAI.</p>
<ul class="simple">
<li><p>ou ajoutez-le localement à votre projet avec une commande INSERER</p></li>
<li><p>OID prefixes have to be ordered at <a class="reference external" href="https://www.interlis.ch/en/dienste/oid-bestellen">https://www.interlis.ch/en/dienste/oid-bestellen</a></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you work with different databases for different communities, you should use different OID prefixes for each database.</p>
</div>
</div>
<div class="section" id="working-with-more-than-one-database">
<h2><span class="section-number">1.4.7. </span>Travailler avec plusieurs base de  données<a class="headerlink" href="#working-with-more-than-one-database" title="Lien permanent vers ce titre">¶</a></h2>
<ul class="simple">
<li><p>Create a new database in pgAdmin with a new name, e.g. communityA</p></li>
<li><p>Create a new schema qgep in this database (do not choose another name, because all scripts works with the schema-name qgep)</p></li>
<li><p>Go further on as described in 1.2 Database initialization</p></li>
<li><p>Modifier le fichier <code class="docutils literal notranslate"><span class="pre">pg_service.conf</span></code></p></li>
</ul>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[pg_qgep]</span>
<span class="na">host</span><span class="o">=</span><span class="s">localhost</span>
<span class="na">port</span><span class="o">=</span><span class="s">5432</span>
<span class="na">dbname</span><span class="o">=</span><span class="s">qgep</span>
<span class="na">user</span><span class="o">=</span><span class="s">qgepuser</span>
<span class="k">[pg_communityA]</span>
<span class="na">host</span><span class="o">=</span><span class="s">localhost</span>
<span class="na">port</span><span class="o">=</span><span class="s">5432</span>
<span class="na">dbname</span><span class="o">=</span><span class="s">communityA</span>
<span class="na">user</span><span class="o">=</span><span class="s">qgepuser</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Chercher et remplacer dans la copie de <code class="docutils literal notranslate"><span class="pre">qgep_fr.qgs</span></code> tous les “pg_qgep” avec “pg_communauteA”</p></li>
</ul>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../user-guide/index.html" class="btn btn-neutral float-right" title="2. Guide d’utilisateur de QGEP" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="database-initialization.html" class="btn btn-neutral" title="1.3. Initialisation de la base de données" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, The QGEP Project www.qgis.ch/en/projects/qgep-waste-water-module.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.8',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/language_data.js"></script>
      <script type="text/javascript" src="../_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>